(function(){var f={_options:{},_actionIndex:-1,init:function(b,c){var a=this;this._elem=jQuery(b);this._options=jQuery.extend(this.getDefaultOptions(),c);this._loader=this._elem.find(".mmtl-loader");this._output=this._elem.find(".mmtl-output");this._submit=this._elem.find('input[type="submit"]');this.on("action_before",function(b,c,e){a._elem.find(".mmtl-ajax-hide-on-before").hide();a._submit.prop("disabled",!0).hide();a._loader.show()});this.on("action_complete_success",function(b,c,e,f){a._output.append(f);
a._actionIndex+1>=a.option("actions").length||(a._actionIndex++,setTimeout(function(){a.doAction(a._actionIndex)},1E3))});this.on("action_complete_error",function(b,a,c){});this.on("action_complete",function(b,c,e){e<a._actionIndex||(a._submit.prop("disabled",!1),a._elem.find(".mmtl-ajax-hide-on-complete").hide(),a._elem.find(".mmtl-ajax-show-on-complete").show(),a._loader.hide())});this.on("action_error",function(b,a,c){});this._elem.find("form").submit(function(b){a._actionIndex=0;a.doAction(a._actionIndex);
return!1})},option:function(b){return this._options[b]},getAction:function(b){var c=this.option("actions");return 0>b||b>c.length?null:c[b]},doAction:function(b){var c=this.getAction(b);if(c){var a={},a=(a.action="mmtl_updater_process_action",a.action_id=c,a[this.option("noncename")]=this.option("nonce"),a),d=this;this.trigger("action_before",[c,b]);return jQuery.post(this.option("ajaxurl"),a).done(function(a){a.hasOwnProperty("success")&&a.success?d.trigger("action_complete_success",[c,b,a.data]):
d.trigger("action_complete_error",[c,b,a.data])}).fail(function(){d.trigger("action_error",[c,b])}).always(function(){d.trigger("action_complete",[c,b])})}},trigger:function(){var b=Array.prototype.slice.call(arguments);0<b.length&&(b[0]="mmtl_updater:"+b[0]);jQuery(document).trigger.apply(jQuery(document),b)},on:function(){var b=Array.prototype.slice.call(arguments);0<b.length&&(b[0]="mmtl_updater:"+b[0]);jQuery(document).on.apply(jQuery(document),b)},getDefaultOptions:function(){return{ajaxurl:"",
nonce:"",noncename:"",actions:[]}}};jQuery(document).ready(function(){f.init("#mmtl-updater-screen",MMTL_Updater_Options)})})();